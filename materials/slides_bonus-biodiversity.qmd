---
title: "Intro to Data Science"
author: "Lab 8 -- Biodiversity + Mapping Resources"
engine: knitr
format: 
  revealjs: 
    slide-number: c
    scrollable: false
    code-overflow: wrap
    code-line-numbers: false
    code-copy: hover
    theme: [night, slides.scss]
    reference-location: document
    footer: "[Programming in R for Biologists](https://njlyon0.github.io/teach_r-for-biologists/)"
---

## A Guide to Your Process

### [Scheduling]{.blue}

### [Learning Objectives]{.purple}

### [Practice]{.pink}

### [Supporting Information]{.orange}

### [Class Discussion]{.gold}

## [Today's Plan]{.blue}

- Muddiest Point Review
- Biodiversity & Ecological Communities
- Future Resources
    - Including mapping & geospatial in R!

## [Today's Learning Objectives]{.purple}

After today's session you will be able to:

. . .

- Calculate diversity and species richness with R
- Compute rarefied species richness
- Create a species accumulation curve with `ggplot2`
- Identify useful parts of The Carpentries' tutorials

## [Muddiest Point Review]{.gold}

- Recurring topics from most recent MPs:

\

. . . 

- What other topic(s) would you like to review?

## [Ecology Term Glossary]{.orange} {.smaller}

- [Population]{.gold} = individuals of <u>_one_</u> species in a given habitat / area

\

. . . 

- [Community]{.blue} = individuals of <u>_multiple_</u> species in a given habitat / area

\

. . . 

- [Abundance]{.orange} = number of <u>_individuals_</u> of one or more species

\

. . . 

- [Richness]{.pink} = number of <u>_species_</u> in a given habitat / area

\

. . . 

- [Diversity]{.purple} = index derived from some combination of abundance & richness

## [Ecological Questions]{.orange} {.smaller}

- As ecologists, we're often concerned with biodiversity

\

. . . 

- Our studies often involve data like:
    - Presence or abundance of particular species
    - Number or mix of species in a habitat
    - Habitat characteristics across multiple habitats
    - Scaling the above across space or time (or both!)

\

. . . 

- A _lot_ of different questions fit under the "ecology" umbrella!

## [Ecology Data in R]{.orange} {.smaller}

- Ecological data are famously "messy"
    - A lot of field-collected information
    - Often multiple observers with their own abbreviations or acronyms
    - Many typos or inconsistencies
    - A lot of required processing before data can be visualized / analyzed

\

. . .

- Even when _everything_ goes right, <u>ecology data has a lot of variation</u>
    - The natural world has a lot of "noise" in the data

\

. . .

- Challenge is separating biologically-relevant noise from scientistsâ€™ errors!

## [Ecology R Package]{.orange} {.smaller}

- A lot of data wrangling can be done with whatever package you'd like
    - E.g., `dplyr`,  `tidyr`, base R, etc.

\

. . .

- Some of the special metrics unique to ecology need their own package

\

. . .

- Most of these tools live in the `vegan` package!

\

. . .

- Note on package name
    - Pronounced like the dietary preference
    - Short for "vegetation analysis" (developed by plant people)

## [Diversity Metrics]{.orange} {.smaller}

::::{.columns}

:::{.column width="33.33%"}

### Shannon Diversity

- Higher numbers = more diverse
- Theoretically infinite

\

- Abbreviation is H'
    - "H prime"

:::
:::{.column width="33.33%"}

:::
:::{.column width="33.33%"}


:::
::::

## [Diversity Metrics]{.orange} {.smaller}

::::{.columns}

:::{.column width="33.33%"}

### Shannon Diversity

- Higher numbers = more diverse
- Theoretically infinite

\

- Abbreviation is H'
    - "H prime"

:::
:::{.column width="33.33%"}

### Simpson Diversity

- Ranges from 0 to 1

\

- Abbreviation is D

:::
:::{.column width="33.33%"}

:::
::::

## [Diversity Metrics]{.orange} {.smaller}

::::{.columns}

:::{.column width="33.33%"}

### Shannon Diversity

- Higher numbers = more diverse
- Theoretically infinite

\

- Abbreviation is H'
    - "H prime"

:::
:::{.column width="33.33%"}

### Simpson Diversity

- Ranges from 0 to 1

\

- Abbreviation is D

:::
:::{.column width="33.33%"}

### Species Richness

- Number of species
- Regardless of number of individuals

\

- Abbreviation is S

:::
::::

## [Calculating Diversity in R]{.orange} {.smaller}

- Functions are `diversity` and `specnumber`

\

. . .

- Example syntax:
```{.r}
# Calculate diversity
vegan::diversity(x = community_df, index = "shannon")

# Calculate richness
vegan::specnumber(x = community_df)
```

\

. . .

- Note that the community data needs to be in _wide format_
    - Row = site / location
    - Column = species (either presence/absence or abundance)

## [Community Data in `vegan`]{.orange} {.smaller}

- `vegan` has some built-in community datasets

\

. . .

- We'll use a tree dataset from Barrow Colorado Island (BCI)
    - Hyper-diverse island in Panama
    - Site of a lot of groundbreaking ecological work

![](images/map-bci.png){.absolute top=300 left=700 width="50%"}

\

. . .

- Dataset is one row per sampling site
    - Columns are tree scientific names
    - Values are counts of tree species at that site

## [Practice Prep]{.pink} {.smaller}

![](images/hex-vegan.png){.absolute top=0 left=1100 width="12%"}

- Get prepared
    - Make a new script for today
    - Install/load `vegan` package
    - Load BCI data by running the following code:
    
```{.r}
data(BCI)
```
    
- Check structure of BCI object

\

. . .

- Calculate number of tree species per site (i.e., per row)
    - Use the `specnumber` function in `vegan`

\

. . .

- How many tree species are in the _first_ site?

## [Calculate Diversity]{.pink}

![](images/hex-vegan.png){.absolute top=0 left=1100 width="12%"}

- Calculate _Shannon_ diversity for the BCI data
    - What is the Shannon diversity for the first site?

\

. . .

- Calculate Simpson diversity for the BCI data
    - What is the Simpson diversity for the first site?

## [Temperature Check]{.purple}

#### How are you Feeling?

<p align="center">
<img src="comics/debugging.png" alt="Comic-style graph depicting someone's emotional state as they debug code (from initial struggle and defeat to eventual triumph)">
</p>

## [Rarefaction Background]{.orange} {.smaller}



## [Rarefaction with R]{.orange} {.smaller}



## [Rarefy a Community]{.pink} {.smaller}

![](images/hex-vegan.png){.absolute top=0 left=1100 width="12%"}



## [Species Accumulation Curves (SACs)]{.orange} {.smaller}



## [SAC Example]{.gold} {.smaller}



## [Making a SAC]{.orange} {.smaller}



## [Calculate Species Accumulation]{.pink} {.smaller}

![](images/hex-vegan.png){.absolute top=0 left=1100 width="12%"}



## [Make a SAC]{.pink} {.smaller}

![](images/hex-vegan.png){.absolute top=0 left=1100 width="12%"}
![](images/hex-ggplot2.png){.absolute top=0 left=965 width="12%"}



## [New `ggplot2` Geometry]{.orange} {.smaller}



## [Add Error Bars]{.pink} {.smaller}

![](images/hex-vegan.png){.absolute top=0 left=1100 width="12%"}
![](images/hex-ggplot2.png){.absolute top=0 left=965 width="12%"}





## [Temperature Check]{.purple}

#### How are you Feeling?

<p align="center">
<img src="comics/debugging.png" alt="Comic-style graph depicting someone's emotional state as they debug code (from initial struggle and defeat to eventual triumph)">
</p>

## [Continuing to Explore R]{.orange} {.smaller}



## [The Carpentries]{.orange} {.smaller}



## [My Goal for You]{.purple}

<p align="center">
<img src="comics/r-knowledge.png" alt="Comic-style graph depicting someone's confidence with R changing over time">
</p>

## [Your Accomplishments]{.gold} {.smaller}



## [Closing Thoughts]{.gold} {.smaller}



## [Upcoming Due Dates]{.blue}

- Everything must be turned in at midnight <u>tonight</u>!

\

- Turn in _everything_ you haven't yet as soon as possible
